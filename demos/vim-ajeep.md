---
title: vim常用操作
---

# 模式(状态)

| | |
|-|-|
| normal | 缺省状态，其他状态按ESC返回此状态。除了输入文字，其他操作都是在缺省状态 |
| insert | 缺省状态按i/a/o/O进入输入状态，然后在光标处输入文字，输入完按ESC回缺省状态。输入状态要移动光标只能用方向键不能用hjkl。从系统剪贴板粘帖文本需要处于插入状态。 |
| visual | 选择状态，在缺省状态按v/V等命令开始选择，然后方向确定终点，最后复制剪切等命令回到缺省状态。 |
| command | 这个其实不是状态，从缺省状态键入:或/并继续输入命令，回车即运行命令并回到缺省状态。 |
| 首先记住 | :q 退出vim；:q! 强制退出(不存盘)；<br>:w 保存；:wq 保存并退出 |

# 移动

|  |  |
|-|-|
| ^/0_$ | 到行首 _ 行尾 |
| gg_G_16G/:16 | 到首行 _ 尾行 _ 到第16行 |
| 16 | 输入数值并回车是向后移动这些行，本例为向后移动16行 |
| H_M_L | 光标移到可视区域的上 _ 中 _ 下(hight, middle, low) |
| zt_zz_zb | 将当前行定位到可视区域的上 _ 中 _ 下(top, , bottom) |
| Ctrl-f_b | 向下 _ 向上翻一页(forward, backward) |
| Ctrl-d_u | 向下 _ 向上翻半页(down, up) |
| h_j_k_l | 类似方向键，向左 _ 下 _ 上 _ 右移动，但只能用在非输入状态，输入状态只能用方向键。前面可加数值，例如5h 向左移动5个字符 |
| w_b<br>W_B | 向后 _ 前移动1个单词(中文不好用，大写是以空格分割)，前面可加数值。(word, back)。 |

# 选择

|  |  |
|-|-|
| v | visual，选择开始，从当前字符开始。viw是选中当前单词 |
| V | 行选择，从当前行开始 |
| Ctrl-v | 块选择，从当前字符开始 |
| 选择后的命令 | 用上面3个命令开始选择后，使用方向键、搜索等方法定位到选择终点，然后可以用以下命令结束选择： |
|  | d 删除，y 复制，x 剪切 |
|  | u 小写，U 大写，\~ 大小写反转 |
| 选择范围内替换 | 选择后，直接输入`:s/old/new/g`可将选择范围内的old都替换为new |

# 编辑

|  |  |
|-|-|
| i | insert, 从缺省状态变为插入模式，光标在当前字符前 |
| a | append, 从缺省状态变为插入模式，光标在当前字符后 |
| d | delete, 删除当前字符或选择，可在前面加数值，4d是从当前字符删除4个字符 |
|  | dd 删除当前行，dw 删除到当前单词尾，D/d$ 删除到本行尾 |
| x | 剪切当前字符或选择到vi剪贴板(注意不是系统剪贴板)，可以在前面加数值 |
| y<br>yw<br>yy | yank复制当前字符或选择到vi剪贴板<br>复制当前单词(中文不好用)<br>复制当前行，前面可带数字复制当前行开始的几行 |
| p_P | paste, 将vi剪贴板内容粘贴到当前字符或行后 _ 前 |
| o_O | 在本行后面 _ 前面加空行，并变为插入模式 |
| u_U | undo, 取消前一操作 _ 取消对当前行的所有编辑 |
| J | 将下一行与本行合并，用1个空格连接 |

# 搜索替换

|  |  |
|-|-|
| /abc | /为搜索命令，本例为搜索字符串abc |
| n_N | next, 向下 _ 向上再次搜索 |
| :s/old/new/g | 当前行搜索替换(本例为将old替换为new)，最后的g=global，本行所有old都替换为new，如果没有g则只替换第1个 |
|  | 选择范围内替换：用v/V等选择后，可以直接输入本命令在选择范围中替换。 |
|  | ^和$分别表示行头和行尾，`:s/^/abc/`在行头加abc，`:s/$/abc/`在行尾加abc。这在对一块内容统一加行头很有效，比如：`1,10s/$/- /`给1\~10行加markdown无序列表标记"- " |
| :%s/old/new/g | %表示全文，本命令是全文替换，如果没有g则只替换每行第一个 |
| :3,30s/old/new/g | 范围内替换，本例为从第3\~30行中将old替换为new。`:0,$s/old/new/g`和上一命令效果一样 |
|  | **vi的搜索和替换支持正则表达式，能力强劲** |

# 多窗口

vi中多窗口方便对照和窗口间复制粘贴，无需用鼠标选择

|  |  |
|-|-|
| :sp filename _ :vsp filename | split, 当前窗口切分为两个窗口(vsp的v=vertical)，新窗口中是filename文件，如果不输入filename，则新窗口也是当前文件(可以同时编辑一个文件的不同位置) |
| :o filename | open, 当前窗口打开文件 |
| Ctrl-w w | 切换到下一窗口 |
| Ctrl-w 方向 | 切换窗口，方向可以是方向键或hjkl |

# 设置命令

|  |  |
|-|-|
| :set ignorecase _ noignorecase _ smartcase | 忽略大小写 _ 区分大小写 _ 智能大小写(如果搜索全小写则忽略，如果有大写就区分) |
| :set fileencoding=utf-8 | 设置文件编码(如果没有=及后面内容，则是查看) |
| :set fileformat=unix | 设置文件格式(如果没有=及后面内容，则是查看) |
|  | **vi的很多扩展需要设置命令，自己的常用设置可以放到vim的个人配置文件.vimrc中** |

# Shell命令

|  |  |
|-|-|
| :!shell命令 | 不退出vim运行shell命令 |
| :r!shell命令 | 将shell命令的输出结果插入到当前行下面 |
| :10,20!sort | 将10\~20行的内容作为shell命令(本例如sort)的输入，用命令返回的结果替换10\~20行的内容，类似前面，%相当与0,$ |
| **16进制** | 下面2个命令实际上是对全文调用shell命令xxd |
| :%!xxd | 切换为16进制编辑 |
| :%!xxd -r | 从16进制编辑返回文本编辑 |
